(this["webpackJsonpdbs-visualization"]=this["webpackJsonpdbs-visualization"]||[]).push([[0],{21:function(e,t,a){},29:function(e,t,a){e.exports=a(43)},34:function(e,t,a){},43:function(e,t,a){"use strict";a.r(t),a.d(t,"store",(function(){return J}));var n={};a.r(n),a.d(n,"changeQueryNumberOfRelations",(function(){return w})),a.d(n,"changeQueryGraphType",(function(){return _})),a.d(n,"changeAlgorithm",(function(){return E})),a.d(n,"addVariableRow",(function(){return O})),a.d(n,"popVariableRow",(function(){return R})),a.d(n,"updateSteps",(function(){return S})),a.d(n,"updateConfiguration",(function(){return x})),a.d(n,"increaseStep",(function(){return C})),a.d(n,"decreaseStep",(function(){return N}));var r=a(0),i=a.n(r),o=a(2),l=a.n(o),c=(a(34),a(21),a(4)),s=a(5),u=a(8),h=a(7),d=a(6),p=a(3),f=a(14),v=a(27),g=[{value:"dpccp",label:"DPccp"},{value:"art",label:"Adaptive Radix Tree"}],y=[{value:"chain",label:"Chain"},{value:"star",label:"Star"},{value:"tree",label:"Tree"},{value:"cycle",label:"Cycle"},{value:"moerkotte",label:"Moerkotte QueryCompiler 2018"}],b=(a(41),{3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",10:"10"}),m=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).handleNumberOfRelationsChange=function(t){e.props.actions.changeQueryNumberOfRelations(t)},e.handleGraphTypeChange=function(t){var a=e.props.actions,n=y.findIndex((function(e){return e.value===t.value}));a.changeQueryGraphType(n)},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.graphTypeIndex,t=y[e];return i.a.createElement("div",null,i.a.createElement("h3",null,"Graph"),i.a.createElement("div",null,i.a.createElement("h5",null,"Number of relations"),i.a.createElement(v.a,{className:"slider",marks:b,handleStyle:{background:"white",border:0,height:"26px",width:"26px",marginTop:"-9px"},trackStyle:{background:"white",height:"4px",borderRadius:"0px"},railStyle:{background:"white",height:"4px",borderRadius:"0px"},dotStyle:{height:"20px",transform:"translate(2px, 6px)",border:"none",borderRadius:"0px",width:"3px"},style:{width:"100%"},dots:!0,onChange:this.handleNumberOfRelationsChange,min:3,defaultValue:5,max:10}),i.a.createElement("h5",null,"Graph Type"),i.a.createElement(f.a,{className:"select",name:"color",style:{width:"100%"},defaultValue:y[4],placeholder:"Query Graph",value:t,onChange:this.handleGraphTypeChange,options:y}),"tree"===t.value&&i.a.createElement("div",{className:"info"},"Only complete binary trees are supported.")))}}]),a}(i.a.Component),w=function(e){return{type:"CHANGE_QUERY_NUMBER_RELATIONS",numberOfRelations:e}},_=function(e){return{type:"CHANGE_QUERY_GRAPH_TYPE",graphTypeIndex:e}},E=function(e){return{type:"CHANGE_ALGORITHM",algorithmIndex:e}},O=function(e){return{type:"ADD_VARIABLE_ROW",variableRow:e}},R=function(){return{type:"POP_VARIABLE_ROW"}},S=function(e){return{type:"UPDATE_STEPS",steps:e}},x=function(e){return{type:"UPDATE_CONFIGURATION",configuration:e}},C=function(e){return{type:"INCREASE_STEP",increase:e}},N=function(e){return{type:"DECREASE_STEP",decrease:e}},T=Object(d.b)((function(e){return{numberOfRelations:e.queryGraph.numberOfRelations,graphTypeIndex:e.queryGraph.graphTypeIndex}}),(function(e){return{actions:Object(p.b)(n,e)}}))(m),k=a(12),A=a.n(k),j=a(19),I=Math.PI,G=function(){function e(t){Object(c.a)(this,e),this._nodeColors=[],this._numberOfNodes=0,this._numberOfNodes=t,this._nodeColors=Array(t).fill("white")}return Object(s.a)(e,[{key:"draw",value:function(e,t,a){var n=this;console.log(t),t.forEach((function(e){n._nodeColors[e.nodeIndex]="rgb("+e.color.R+","+e.color.G+","+e.color.B+")"}));var r=window.devicePixelRatio||1,i=a.canvas.getBoundingClientRect();a.canvas.width=i.width*r,a.canvas.height=i.height*r,a.clearRect(0,0,a.canvas.clientWidth,a.canvas.clientHeight),a.scale(r,r),a.strokeStyle="rgb(250, 250, 250)",a.fillStyle="rgb(250, 250, 250)";var o=this._numberOfNodes;switch(e){case"chain":this._drawChainQuery(o,a);break;case"star":this._drawStarQuery(o,a);break;case"tree":this._drawTreeQuery(o,a);break;case"cyclic":this._drawCyclicQuery(o,a);break;case"cycle":this._drawCycleQuery(o,a);break;case"grid":this._drawGridQuery(o,a);break;case"clique":this._drawCliqueQuery(o,a);break;case"moerkotte":this._drawMoerkotteQuery(a)}}},{key:"_drawChainQuery",value:function(e,t){for(var a=0;a<e;a++){var n=t.canvas.clientWidth-24-40,r=32+a*n/(e-1);if(this._drawNode(a,r,200,"white",t),0!==a){var i=32+(a-1)*n/(e-1);this._drawLine(r,200,i,200,t)}}}},{key:"_drawStarQuery",value:function(e,t){for(var a=0;a<e;a++){var n=t.canvas.clientWidth/2,r=t.canvas.clientHeight/2;if(0!==a){var i=2*I/(e-1)*a,o=t.canvas.clientWidth/2-20-12,l=o*Math.cos(i)+o+20+12,c=o*Math.sin(i)+o+20+12;this._drawLine(l,c,n,r,t),this._drawNode(a,l,c,"white",t)}else this._drawNode(a,n,r,"white",t)}}},{key:"_drawTreeQuery",value:function(e,t){for(var a=t.canvas.clientWidth-24-40,n=t.canvas.clientWidth-24-40,r=t.canvas.clientWidth/2,i=n/Math.floor(Math.log2(e)),o=0;o<e;o++)if(0!==o){var l=function(e){return Math.floor(Math.log2(e+1))},c=l(o),s=function(e){return Math.pow(2,e)},u=s(c),h=function(e,t){return e-Math.pow(2,t)+1},d=function(e,t){return(e+.5)*a/t+12+20},p=function(e){return 32+i*e},f=d(h(o,c),u),v=p(c);this._drawNode(o,f,v,"white",t);var g=Math.floor((o-1)/2),y=l(g),b=s(y),m=d(h(g,y),b),w=p(y);this._drawLine(f,v,m,w,t)}else this._drawNode(o,r,32,"white",t)}},{key:"_drawMoerkotteQuery",value:function(e){var t=e.canvas.clientWidth,a=e.canvas.clientHeight,n=e.canvas.clientWidth/2,r=e.canvas.clientHeight/2,i=n,o=r,l=n,c=r,s=t-32,u=r,h=n,d=a-32;this._drawNode(0,i,32,"white",e),this._drawNode(1,32,o,"white",e),this._drawNode(2,l,c,"white",e),this._drawNode(3,s,u,"white",e),this._drawNode(4,h,d,"white",e),this._drawLine(i,32,32,o,e),this._drawLine(i,32,l,c,e),this._drawLine(i,32,s,u,e),this._drawLine(32,o,h,d,e),this._drawLine(l,c,s,u,e),this._drawLine(l,c,h,d,e),this._drawLine(s,u,h,d,e)}},{key:"_drawCyclicQuery",value:function(e,t){}},{key:"_drawCycleQuery",value:function(e,t){for(var a=0;a<e;a++){var n=2*I/e*a,r=t.canvas.clientWidth/2-20-12,i=r*Math.cos(n)+r+20+12,o=r*Math.sin(n)+r+20+12;this._drawNode(a,i,o,"white",t);var l=2*I/e*(a-1),c=r*Math.cos(l)+r+20+12,s=r*Math.sin(l)+r+20+12;this._drawLine(i,o,c,s,t)}}},{key:"_drawGridQuery",value:function(e,t){}},{key:"_drawCliqueQuery",value:function(e,t){}},{key:"_drawNode",value:function(e,t,a,n,r){r.fillStyle=this._nodeColors[e],r.beginPath(),r.arc(t,a,20,0,2*I),r.fill(),r.font="20px sans-serif",r.fillStyle="rgb(30, 33, 39)",r.textBaseline="middle",r.textAlign="center",r.fillText("R"+e,t,a)}},{key:"_drawLine",value:function(e,t,a,n,r){var i=r.globalCompositeOperation;r.globalCompositeOperation="destination-over",r.beginPath(),r.moveTo(e,t),r.lineTo(a,n),r.stroke(),r.globalCompositeOperation=i}}]),e}(),Q=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={initialGraphState:[],graphState:[],counters:[],diffs:[]},n.handleAlgorithmChange=function(e){n.setState({algorithm:e},(function(){n.updateAlgorithm()}))},n.handleNextStep=function(e){var t=n.state,a=t.graphState,r=t.diffs[e+1];console.log("Next step"),console.log(r),console.log(n.state),n.props.actions.increaseStep(1),n.setState({graphState:Object.assign(a,r.graphState)})},n.handlePreviousStep=function(e){var t=n.state,a=t.graphState,r=t.diffs[e-1],i=Object.assign(a,r.graphState);n.props.actions.decreaseStep(1),n.setState({graphState:i})},n.algorithmCanvasRef=i.a.createRef(),n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(){this.redrawGraph()}},{key:"componentDidMount",value:function(){var e=Object(j.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.updateAlgorithm();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateAlgorithm",value:function(){var e=Object(j.a)(A.a.mark((function e(){var t,a,n,r,i,o,l;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.actions,n=t.numberOfRelations,r=t.graphTypeIndex,i=y[r],e.next=4,fetch("https://dbs-visualization.ew.r.appspot.com/api/algorithm/"+this.props.algorithm.value+"/relations/"+n+"/graphType/"+i.value);case 4:return o=e.sent,e.next=7,o.json();case 7:l=e.sent,console.log("Res"),console.log(o),console.log(l),a.updateConfiguration(l.configuration),a.updateSteps(l.diffs),this.setState({initialGraphState:JSON.parse(JSON.stringify(l.begin.graphState)),graphState:l.diffs[0].graphState,counters:l.begin.counters,diffs:l.diffs,step:0});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"redrawGraph",value:function(){var e=this.algorithmCanvasRef.current.getContext("2d"),t=this.props,a=t.numberOfRelations,n=t.graphTypeIndex,r=new G(a),i=y[n],o=this.state.graphState;r.draw(i.value,o.nodeColors,e)}},{key:"render",value:function(){var e=this,t=this.state,a=t.algorithm,n=t.diffs,r=this.props.step;return i.a.createElement("div",null,i.a.createElement("h3",null,"Algorithm"),i.a.createElement(f.a,{name:"color",className:"select",defaultValue:g[0],placeholder:"Query Graph",value:a,onChange:this.handleAlgorithmChange,options:g}),i.a.createElement("button",{onClick:function(){return e.handlePreviousStep(r)},disabled:0===r},"Previous Step"),i.a.createElement("button",{onClick:function(){return e.handleNextStep(r)},disabled:r===n.length-1},"Next Step"),i.a.createElement("p",null,"Step ",r+1," of ",n.length),i.a.createElement("canvas",{ref:this.algorithmCanvasRef,width:"400px",height:"400px",style:{width:"400px",height:"400px"}}))}}]),a}(i.a.Component),P=Object(d.b)((function(e){return{algorithm:g[e.algorithmIndex],numberOfRelations:e.queryGraph.numberOfRelations,graphTypeIndex:e.queryGraph.graphTypeIndex,step:e.step}}),(function(e){return{actions:Object(p.b)(n,e)}}))(Q),L=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props,t=e.actions,a=e.configuration,n=e.step,r=this.props.steps.slice(0,n);console.log("OOYOF"),console.log(t),console.log(r),console.log(r[0]),console.log(a);var o=a.observedVariables;return i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,o.map((function(e){return i.a.createElement("th",{key:e},e)})))),i.a.createElement("tbody",null,r.map((function(e,t){return i.a.createElement("tr",null,o.map((function(a,n){var r;return i.a.createElement("td",{key:a+t+n},"{",null===(r=e.variables[a])||void 0===r?void 0:r.join(", "),"}")})))}))))}}]),a}(i.a.Component),M=Object(d.b)((function(e){return{steps:e.steps,step:e.step,configuration:e.configuration}}),(function(e){return{actions:Object(p.b)(n,e)}}))(L),D=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("div",{style:{width:"400px",flex:"0 0 400px",justifyContent:"space-between",marginRight:"80px"}},i.a.createElement(T,null),i.a.createElement(P,null)),i.a.createElement("div",{style:{width:"1 1 100%"}},i.a.createElement(M,null)))}}]),a}(i.a.Component);var W=function(){return i.a.createElement("div",{className:"App"},i.a.createElement("header",{className:"App-header"},i.a.createElement("h1",null,"Database Algorithms Visualization")),i.a.createElement(D,null))},U=a(26);var H=a(13),V={numberOfRelations:5,graphTypeIndex:4};var B=a(28);var q={observedVariables:[]};var Y=Object(p.c)({queryGraph:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;switch(console.log(e),t.type){case"CHANGE_QUERY_GRAPH_TYPE":return Object(H.a)(Object(H.a)({},e),{},{graphTypeIndex:t.graphTypeIndex});case"CHANGE_QUERY_NUMBER_RELATIONS":return Object(H.a)(Object(H.a)({},e),{},{numberOfRelations:t.numberOfRelations});default:return e}},variables:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_VARIABLE_ROW":return[].concat(Object(B.a)(e),[t.variableRow]);case"POP_VARIABLE_ROW":return e.slice(0,-1);default:return e}},algorithmIndex:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_ALGORITHM":return t.algorithmIndex;default:return e}},steps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_STEPS":return t.steps;default:return e}},step:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INCREASE_STEP":return e+t.increase;case"DECREASE_STEP":return e-t.decrease;default:return e}},configuration:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CONFIGURATION":return t.configuration;default:return e}}}),z=function(e,t){return"CLEAR_STATE"===t.type&&(e=void 0),Y(e,t)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var J=Object(p.e)(z,Object(p.d)(Object(p.a)(U.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));l.a.render(i.a.createElement(d.a,{store:J},i.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[29,1,2]]]);
//# sourceMappingURL=main.17a9af57.chunk.js.map